"use strict";(()=>{(function(){"use strict";if(typeof window>"u")return;let l=50;function d(r,a,o,n){let t={ts:new Date().toISOString(),level:r,message:a,source:"early-patch",category:o,...n!==void 0?{data:n}:{}};if(window.__GASOLINE_INJECT_READY__)try{window.postMessage({type:"GASOLINE_LOG",payload:{ts:t.ts,level:t.level,message:t.message,source:t.source,category:t.category,type:"early_patch",...t.data!==void 0?{data:t.data}:{}}},window.location.origin);return}catch{}let e=window.__GASOLINE_EARLY_LOGS__||[];e.push(t),e.length>l&&e.splice(0,e.length-l),window.__GASOLINE_EARLY_LOGS__=e}let w=Element.prototype.attachShadow;if(w&&!window.__GASOLINE_CLOSED_SHADOWS__){let r=new WeakMap;window.__GASOLINE_CLOSED_SHADOWS__=r,window.__GASOLINE_ORIGINAL_ATTACH_SHADOW__=w;let a=0,o=w,n=function(e){let s=o.call(this,e);return e.mode==="closed"&&r.set(this,s),s},t=Object.getOwnPropertyDescriptor(Element.prototype,"attachShadow");try{Object.defineProperty(Element.prototype,"attachShadow",{configurable:!0,enumerable:t?.enumerable??!1,get(){return n},set(e){if(typeof e!="function"){d("warn","attachShadow overwrite ignored (non-function)","shadow_dom",{assigned_type:typeof e});return}if(e===n)return;let s=e;o=function(u){return s.call(this,u)},a+=1;let p=s.__gasolineMarker;d("warn","attachShadow overwrite intercepted","shadow_dom",{overwrite_count:a,replacement_name:s.name||"anonymous",...p?{marker:p}:{}})}})}catch(e){d("error","attachShadow hardening install failed; using fallback wrapper","shadow_dom",{error:e instanceof Error?e.message:String(e)}),Element.prototype.attachShadow=n}}if(!window.WebSocket||window.__GASOLINE_ORIGINAL_WS__)return;let c=window.WebSocket;window.__GASOLINE_ORIGINAL_WS__=c;let _=[];window.__GASOLINE_EARLY_WS__=_;function i(r,a){let o=a!==void 0?new c(r,a):new c(r),n={ws:o,url:r.toString(),createdAt:Date.now(),events:[]};return o.addEventListener("open",()=>{n.events.push({type:"open",ts:Date.now()})}),o.addEventListener("close",t=>{n.events.push({type:"close",ts:Date.now(),code:t.code,reason:t.reason})}),o.addEventListener("error",()=>{n.events.push({type:"error",ts:Date.now()})}),_.push(n),_.length>50&&_.shift(),o}i.prototype=c.prototype,Object.defineProperty(i,"CONNECTING",{value:0,writable:!1}),Object.defineProperty(i,"OPEN",{value:1,writable:!1}),Object.defineProperty(i,"CLOSING",{value:2,writable:!1}),Object.defineProperty(i,"CLOSED",{value:3,writable:!1}),window.WebSocket=i})();})();
//# sourceMappingURL=early-patch.bundled.js.map
